<script>
   function crearTablaContactos()
   {let tabla = document.getElementById('tablaContactos');
    if(tabla) tabla.remove();
        google.script.run.withSuccessHandler( 
            function(obj)
            {   tabla = document.createElement('table');
                tabla.id = 'tablaContactos';

                let tablaHeader = document.createElement('thead');
                let tablaBody = document.createElement('tbody');

                for(let i = 0; i < obj.length; i++)
                {
                    let fila = document.createElement('tr'); 
                    for(let j = 0; j<obj[i].length; j++)
                    {
                        let celda = document.createElement('td');
                        celda.textContent = obj[i][j];
                        fila.appendChild(celda);
                    }
                    if(i == 0)
                    {
                        tablaHeader.appendChild(fila);
                        tabla.appendChild(tablaHeader);
                    }
                    else
                    {
                     tablaBody.appendChild(fila);
                    }
                }
                //agregamos clases a la cabecera
                tablaHeader.classList.add('table-dark');

                //agregamos el cuerpo a la tabla
                tabla.appendChild(tablaBody);

                //agragamos clases a la tabla
                tabla.classList.add('table','table-striped','border','border-3','table-success');

                //agregamos tabla a la pÃ gina
                document.getElementById('divContactos').appendChild(tabla);
            }
        ).obtenerContactos();
    }
</script>

